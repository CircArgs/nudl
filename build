#!/bin/sh
rm -rf $PWD/cache
mkdir $PWD/cache
cp $PWD/nimbase.h $PWD/cache
rm $PWD/commands.txt

# --nimcache:$PWD/cache \
# we use our own cache just so we can read the code
nim c \
-d:release \
--nimcache:$PWD/cache \
--cc:gcc \
--gcc.exe: "$PWD/nudlcc" \
--gcc.linkerexe: "$PWD/nudlcc" \
--gcc.cpp.options.debug: "-Xcompiler -Og" \
--gcc.cpp.options.speed: "-Xcompiler -O3" \
--gcc.cpp.options.size: "-Xcompiler -Os" \
--gcc.cpp.options.always:"--x cu -ccbin=gcc-5" \
src/cuda.nim